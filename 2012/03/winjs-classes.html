<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="/images/favicon.png" />
    <style>
    html,body,li,p{margin:0;padding:0}p,ul,ol,.highlight{margin:1.6em 0}h1,h2,h3,h4{margin:0;padding:0;font-size:100%;font-weight:bold;text-rendering:optimizeLegibility;font-family:sans-serif}ul{list-style:none}html{box-sizing:border-box;font-size:62.5%}*{box-sizing:inherit}*:before,*:after{box-sizing:inherit}img{height:auto;max-width:100%}pre,code{font-family:monospace;margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:1rem 0;padding:0}blockquote{font-style:italic;margin:1.6em 0 1.6em -2.2em;padding:0 0 0 1.6em;border-left:#4a4a4a 0.4em solid}html{font-size:16px}@media screen and (min-width: 900px){html{font-size:18px}}@media screen and (min-width: 1200px){html{font-size:20px}}body{font-family:serif;color:#3A4145}h1{font-size:2rem;margin:10px 0 10px 0;letter-spacing:-1px}h2{font-size:1.4rem;letter-spacing:-1px}h3{font-size:1.2rem}h4{font-size:1.1rem}a:link,a:visited{color:inherit;text-decoration:none}a:hover{color:#57A3E8;transition:color ease 0.3s}p a:link,p a:visited{text-decoration:underline}pre{border:1px solid #E3EDF3;padding:10px;font-size:0.85em;border-radius:3px}code{padding:1px 3px;font-size:0.85em;white-space:pre;border:1px solid #E3EDF3;background:#F7FAFB;border-radius:2px}pre code{background:transparent;padding:0;border:0}.m-h{text-align:center;background-color:#303538;color:#fff;padding:1rem}.m-h h2{font-weight:normal;font-size:1.5rem}article{width:80%;margin:1rem auto;padding-bottom:1rem;border-bottom:#EBF2F6 1px solid;word-break:break-word;position:relative}article::after{display:block;content:"";width:7px;height:7px;border:#E7EEF2 1px solid;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;box-shadow:#fff 0 0 0 5px}.a-m{color:#9EABB3;font-size:0.8rem}.a-m a:hover{color:#9EABB3;text-decoration:underline}.a-h{margin-bottom:5px}.r-m{font-size:smaller}nav{position:relative;width:75%;margin:1rem auto;font-size:0.8rem;color:#9EABB3;text-align:center}.m-f{position:relative;margin:2rem 0 0 0;padding:1rem 1rem 2rem 1rem;border-top:#EBF2F6 1px solid;font-size:0.8rem;line-height:1.7em;color:#BBC7CC;text-align:center;background:#F7FAFB}.o-p,.n-p{position:absolute;display:inline-block;padding:0 0.5rem;border:#EBF2F6 2px solid;text-decoration:none;border-radius:30px;transition:border ease 0.3s}.o-p{right:0}.n-p{left:0}.t-h{width:80%;margin:0 auto}.highlight pre{background-color:#49483e;color:white;overflow:scroll}.ge{font-style:italic}.gs{font-weight:bold}.c,.cm,.cp,.c1,.gu,.cs{color:#75715e}.k,.kc,.kd,.kp,.kr,.no,.kt{color:#66d9ef}.l,.mf,.mh,.mi,.mo,.se,.il,.m{color:#ae81ff}.n,.nb,.ni,.nl,.nn,.py,.nv,.w,.bp,.vc,.vg,.vi,.p{color:#f8f8f2}.o,.nt,.ow,.gd,.kn{color:#f92672}.ld,.sb,.sc,.sd,.s2,.sh,.si,.sx,.sr,.s1,.ss,.s{color:#e6db74}.na,.nc,.nd,.ne,.nf,.nx,.gi{color:#a6e22e}

    </style>

    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>WinJS - Classes - Chris Sainty</title>
<meta property="og:title" content="WinJS - Classes" />
<meta name="description" content="In my last two posts on JavaScript for Windows 8 I looked at scope and namespaces. I pointed out that namespaces could be used to create “static” classes. I hasten to add they can be used for more, don’t make a hard link in your brain between namespaces and static classes." />
<meta property="og:description" content="In my last two posts on JavaScript for Windows 8 I looked at scope and namespaces. I pointed out that namespaces could be used to create “static” classes. I hasten to add they can be used for more, don’t make a hard link in your brain between namespaces and static classes." />
<link rel="canonical" href="https://blog.csainty.com/2012/03/winjs-classes.html" />
<meta property="og:url" content="https://blog.csainty.com/2012/03/winjs-classes.html" />
<meta property="og:site_name" content="Chris Sainty" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-03-10T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@csainty" />
<meta name="twitter:creator" content="@Chris Sainty" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "WinJS - Classes",
    "datePublished": "2012-03-10T00:00:00+00:00",
    "description": "In my last two posts on JavaScript for Windows 8 I looked at scope and namespaces. I pointed out that namespaces could be used to create “static” classes. I hasten to add they can be used for more, don’t make a hard link in your brain between namespaces and static classes.",
    "url": "https://blog.csainty.com/2012/03/winjs-classes.html"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
  <header class="m-h">
    <h1><a href="https://blog.csainty.com">Chris Sainty</a></h1>
    <h2>A technical blog covering full-stack web development.</h2>
    <h2><a href="https://twitter.com/csainty" rel="external">twitter</a> | <a href="https://github.com/csainty" rel="external">github</a> | <a href="https://stackoverflow.com/users/625695/chris-sainty" rel="external">stackoverflow</a></h2>
  </header>

  <article>
    <span><time datetime="10 Mar 2012">10 Mar 2012</time>  </span>
    <h1>WinJS - Classes</h1>
    <section>
        <p>In my last two posts on JavaScript for Windows 8 I looked at <a href="/2012/03/windows-8-winrt-and-winjs-scope.html">scope</a> and <a href="/2012/03/winjs-namespaces.html">namespaces</a>. I pointed out that namespaces could be used to create “static” classes. I hasten to add they can be used for more, don’t make a hard link in your brain between namespaces and static classes.</p>

<!-- more -->

<p>So what about regular classes. There are a couple of ways to define a class in JavaScript, a simple way is to return a hash from a factory method.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">createPerson</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">name</span><span class="p">,</span>
        <span class="na">sayHello</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hello "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">sue</span> <span class="o">=</span> <span class="nx">createPerson</span><span class="p">(</span><span class="s1">'sue'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bill</span> <span class="o">=</span> <span class="nx">createPerson</span><span class="p">(</span><span class="s1">'bill'</span><span class="p">);</span>
<span class="nx">sue</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>
<span class="nx">bill</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>
</code></pre></div>
<p>We can shift name into a private scope by declaring a new variable inside our constructor which is captured by the resulting object.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">createPerson</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">sayHello</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hello "</span> <span class="o">+</span> <span class="nx">_name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">sue</span> <span class="o">=</span> <span class="nx">createPerson</span><span class="p">(</span><span class="s1">'sue'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bill</span> <span class="o">=</span> <span class="nx">createPerson</span><span class="p">(</span><span class="s1">'bill'</span><span class="p">);</span>
<span class="nx">sue</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>
<span class="nx">bill</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>
</code></pre></div>
<p>However, for complex classes you intend to create a lot of, this method is generally not the suggested. Each instance is redefining the functions rather than simply pointing to an existing implementation in memory. This is where prototype inheritance comes in.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sayHello</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hello "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">sue</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">'sue'</span><span class="p">);</span>
<span class="nx">sue</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>     <span class="c1">// prints Hello sue</span>
<span class="kd">var</span> <span class="nx">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">'bill'</span><span class="p">);</span>
<span class="nx">bill</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>    <span class="c1">// prints Hello bill</span>

</code></pre></div>
<p>With this setup you start with your constructor, you then extend it’s <code>prototype</code>. Finally instead of calling the constructor directly, you call it with the <code>new</code> keyword, which creates you a new instance.</p>

<p>Note the capital P in <code>Person</code>, this is a convention to say this function is a class definition, so call it with <code>new</code>.</p>

<p>But, we have lost the private scoping on the name property. To get it back, we need to define the property inside the constructor like we did above, but then expose it with a getter method so that the methods on the prototypes can get at it.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ctor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">_name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">_name</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// Wrap the private variable with a getter</span>
    <span class="p">};</span>

    <span class="nx">ctor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sayHello</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hello "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">get_name</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">ctor</span><span class="p">;</span>
<span class="p">})();</span>

<span class="kd">var</span> <span class="nx">sue</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">'sue'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">'bill'</span><span class="p">);</span>
<span class="nx">sue</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>     <span class="c1">// prints Hello sue</span>
<span class="nx">bill</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span>    <span class="c1">// prints Hello bill</span>

</code></pre></div>
<p>It’s starting to get ugly isn’t it. Getting our reference to <code>Person</code> back out is quite awkward. The getter isn&#39;t much fun either.</p>

<p>So what does WinJS bring to the table?</p>

<p>There is a <code>WinJS.Class</code> namespace that contains a <code>define</code> method. It can be used to wrap up a big ugly class definition like that above into a simple method call that returns a class definition you can new up. It supports passing in your constructor, your instance methods/properties and your static methods/properties.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Person.js</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">WinJS</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">sayHello</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hello "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">createPerson</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">WinJS</span><span class="p">.</span><span class="nx">Namespace</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">"MyApp"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">Person</span><span class="p">:</span> <span class="nx">Person</span>
    <span class="p">});</span>
<span class="p">})();</span>


<span class="c1">// Page.js</span>
<span class="kd">var</span> <span class="nx">bill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApp</span><span class="p">.</span><span class="nx">Person</span><span class="p">(</span><span class="s2">"bill"</span><span class="p">);</span>    <span class="c1">// Created with constructor</span>
<span class="nx">bill</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span> <span class="c1">// Print Hello bill</span>

<span class="kd">var</span> <span class="nx">jim</span> <span class="o">=</span> <span class="nx">MyApp</span><span class="p">.</span><span class="nx">Person</span><span class="p">.</span><span class="nx">createPerson</span><span class="p">(</span><span class="s2">"jim"</span><span class="p">);</span> <span class="c1">// Created with static contructor</span>
<span class="nx">jim</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">();</span> <span class="c1">// Prints Hello jim</span>
</code></pre></div>
<p>Much cleaner. Our class definition is sitting in the <code>MyApp</code> namespace ready to be created via <code>new MyApp.Person(&#39;&#39;)</code> and for good measure there is a static factory method <code>MyApp.Person.createPerson(&#39;&#39;)</code>.</p>

<p>But what about private variables? You can use the same technique as my example above with the getter. If you had a lot of them you might wrap them all onto a single private hash that only needed a single getter. What you might see a lot of people do is simply prefix them with an underscore and hope others follow the convention that properties starting with an underscore are not to be touched.</p>

<p>Private scope aside, by combining <code>WinJS.Namespace</code> and <code>WinJS.Class</code> you have a really nice set of helpers to wrap up the task of correctly managing global scope and efficient class definitions. Neither is performing any magic, their source code is there for you to explore, they just get rid of some of the confusing boilerplate.</p>

    </section>
</article>


  <footer class="m-f">
      <section class="copyright">All content copyright <a href="/">Chris Sainty</a> &copy; 2006-2017 &bull; All rights reserved.</section>
  </footer>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="/images/favicon.png" />
    <style>
    html,body,li,p{margin:0;padding:0}p,ul,ol,.highlight{margin:1.6em 0}h1,h2,h3,h4{margin:0;padding:0;font-size:100%;font-weight:bold;text-rendering:optimizeLegibility;font-family:sans-serif}ul{list-style:none}html{box-sizing:border-box;font-size:62.5%}*{box-sizing:inherit}*:before,*:after{box-sizing:inherit}img{height:auto;max-width:100%}pre,code{font-family:monospace;margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:1rem 0;padding:0}blockquote{font-style:italic;margin:1.6em 0 1.6em -2.2em;padding:0 0 0 1.6em;border-left:#4a4a4a 0.4em solid}html{font-size:16px}@media screen and (min-width: 900px){html{font-size:18px}}@media screen and (min-width: 1200px){html{font-size:20px}}body{font-family:serif;color:#3A4145}h1{font-size:2rem;margin:10px 0 10px 0;letter-spacing:-1px}h2{font-size:1.4rem;letter-spacing:-1px}h3{font-size:1.2rem}h4{font-size:1.1rem}a:link,a:visited{color:inherit;text-decoration:none}a:hover{color:#57A3E8;transition:color ease 0.3s}p a:link,p a:visited{text-decoration:underline}pre{border:1px solid #E3EDF3;padding:10px;font-size:0.85em;border-radius:3px}code{padding:1px 3px;font-size:0.85em;white-space:pre;border:1px solid #E3EDF3;background:#F7FAFB;border-radius:2px}pre code{background:transparent;padding:0;border:0}.m-h{text-align:center;background-color:#303538;color:#fff;padding:1rem}.m-h h2{font-weight:normal;font-size:1.5rem}article{width:80%;margin:1rem auto;padding-bottom:1rem;border-bottom:#EBF2F6 1px solid;word-break:break-word;position:relative}article::after{display:block;content:"";width:7px;height:7px;border:#E7EEF2 1px solid;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;box-shadow:#fff 0 0 0 5px}.a-m{color:#9EABB3;font-size:0.8rem}.a-m a:hover{color:#9EABB3;text-decoration:underline}.a-h{margin-bottom:5px}.r-m{font-size:smaller}nav{position:relative;width:75%;margin:1rem auto;font-size:0.8rem;color:#9EABB3;text-align:center}.m-f{position:relative;margin:2rem 0 0 0;padding:1rem 1rem 2rem 1rem;border-top:#EBF2F6 1px solid;font-size:0.8rem;line-height:1.7em;color:#BBC7CC;text-align:center;background:#F7FAFB}.o-p,.n-p{position:absolute;display:inline-block;padding:0 0.5rem;border:#EBF2F6 2px solid;text-decoration:none;border-radius:30px;transition:border ease 0.3s}.o-p{right:0}.n-p{left:0}.t-h{width:80%;margin:0 auto}.highlight pre{background-color:#49483e;color:white;overflow:scroll}.ge{font-style:italic}.gs{font-weight:bold}.c,.cm,.cp,.c1,.gu,.cs{color:#75715e}.k,.kc,.kd,.kp,.kr,.no,.kt{color:#66d9ef}.l,.mf,.mh,.mi,.mo,.se,.il,.m{color:#ae81ff}.n,.nb,.ni,.nl,.nn,.py,.nv,.w,.bp,.vc,.vg,.vi,.p{color:#f8f8f2}.o,.nt,.ow,.gd,.kn{color:#f92672}.ld,.sb,.sc,.sd,.s2,.sh,.si,.sx,.sr,.s1,.ss,.s{color:#e6db74}.na,.nc,.nd,.ne,.nf,.nx,.gi{color:#a6e22e}

    </style>

    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>LINQ to SQL: Lambda Expressions - Chris Sainty</title>
<meta property="og:title" content="LINQ to SQL: Lambda Expressions" />
<meta name="description" content="At first glance, Lambda Expressions are bound to confuse most people. Myself included. However, a little digging and experimenting will show they are a simple enough concept. I will cover them now to try remove any confusion in later code snippets." />
<meta property="og:description" content="At first glance, Lambda Expressions are bound to confuse most people. Myself included. However, a little digging and experimenting will show they are a simple enough concept. I will cover them now to try remove any confusion in later code snippets." />
<link rel="canonical" href="https://blog.csainty.com/2007/12/linq-to-sql-lambda-expressions.html" />
<meta property="og:url" content="https://blog.csainty.com/2007/12/linq-to-sql-lambda-expressions.html" />
<meta property="og:site_name" content="Chris Sainty" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-12-31T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@csainty" />
<meta name="twitter:creator" content="@Chris Sainty" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "LINQ to SQL: Lambda Expressions",
    "datePublished": "2007-12-31T00:00:00+00:00",
    "description": "At first glance, Lambda Expressions are bound to confuse most people. Myself included. However, a little digging and experimenting will show they are a simple enough concept. I will cover them now to try remove any confusion in later code snippets.",
    "url": "https://blog.csainty.com/2007/12/linq-to-sql-lambda-expressions.html"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
  <header class="m-h">
    <h1><a href="https://blog.csainty.com">Chris Sainty</a></h1>
    <h2>A technical blog covering full-stack web development.</h2>
    <h2><a href="https://twitter.com/csainty" rel="external">twitter</a> | <a href="https://github.com/csainty" rel="external">github</a> | <a href="https://stackoverflow.com/users/625695/chris-sainty" rel="external">stackoverflow</a></h2>
  </header>

  <article>
    <span><time datetime="31 Dec 2007">31 Dec 2007</time>  </span>
    <h1>LINQ to SQL&#58; Lambda Expressions</h1>
    <section>
        <p>At first glance, Lambda Expressions are bound to confuse most people. Myself included. However, a little digging and experimenting will show they are a simple enough concept. I will cover them now to try remove any confusion in later code snippets.</p>

<!-- more -->

<p>Lets have a look at one of the overloads for the <code>Where()</code> method.<br>
<strong>Note:</strong> All clauses in a LINQ expression can also be expressed as methods. They behave identically and are interchangeable, even within a LINQ expression!</p>

<p><img src="/images/1382874053694.png" alt="Where"> </p>

<p>You will see the parameter &quot;predicate&quot; is of type <code>Func&lt;SaleOrderHeader,bool&gt;</code><br>
What this means is that you pass the <code>Where()</code> method an anonymous function that takes a <code>SaleOrderHeader</code> object (representing a row from the table) and returns a bool that indicates is this row is to be included in the results.
The old (cumbersome) way of specifying this function was as follows</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">AdventureWorksDataContext</span> <span class="n">db</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AdventureWorksDataContext</span><span class="p">();</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="n">SalesOrderHeader</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;</span> <span class="n">f</span> <span class="p">=</span> <span class="k">delegate</span><span class="p">(</span><span class="n">SalesOrderHeader</span> <span class="n">s</span><span class="p">){</span><span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="n">OnlineOrderFlag</span><span class="p">;};</span>
<span class="n">db</span><span class="p">.</span><span class="n">SalesOrderHeaders</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
</code></pre></div>
<p>What Lambda Expressions provide is an inline succinct way of achieving exactly the same result.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">AdventureWorksDataContext</span> <span class="n">db</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AdventureWorksDataContext</span><span class="p">();</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="n">SalesOrderHeader</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;</span> <span class="n">f</span> <span class="p">=</span> <span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">OnlineOrderFlag</span><span class="p">;</span>
<span class="n">db</span><span class="p">.</span><span class="n">SalesOrderHeaders</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="c1">// or //
</span><span class="n">db</span><span class="p">.</span><span class="n">SalesOrderHeaders</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">OnlineOrderFlag</span><span class="p">);</span>
</code></pre></div>
<p>Reading a Lambda Expression is simple enough, the expression is separated into two parts either side of the <code>=&gt;</code> operator. The left hand side defines the parameters, the types of which are usually implied. The right hand side is an expression that uses these parameters and evaluates to the defined return type. The whole expression is type checked, so intellisense will help you out, and the compiler will flag any problems.<br>
Lambda Expressions are not unique to LINQ, they can be used anywhere you might already use an anonymous method. What they provide LINQ however is a far more readable syntax.<br>
One last note, because LINQ uses delegates it gives you an opportunity to build logic into your queries that is quite useful and readable.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">AdventureWorksDataContext</span> <span class="n">db</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AdventureWorksDataContext</span><span class="p">();</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="n">SalesOrderHeader</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;</span> <span class="n">f</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">b</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">f</span> <span class="p">=</span> <span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">OrderDate</span> <span class="p">==</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">f</span> <span class="p">=</span> <span class="n">s</span> <span class="p">=&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">OrderDate</span> <span class="p">&lt;</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">q</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">SalesOrderHeaders</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
</code></pre></div>
<p>As this code snippet shows, applying different filters based on a condition is now a fairly simple task. The variable <code>q</code> of type <code>IEnumerable&lt;SalesOrderHeader&gt;</code> will contain all the orders either from today, or before today, depending on the value of b. </p>

<p>I will be using this technique more often in future posts, and it is an important concept to understand, otherwise your queries are going to be difficult to piece together.</p>

    </section>
</article>


  <footer class="m-f">
      <section class="copyright">All content copyright <a href="/">Chris Sainty</a> &copy; 2006-2017 &bull; All rights reserved.</section>
  </footer>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="/images/favicon.png" />
    <style>
    html,body,li,p{margin:0;padding:0}p,ul,ol,.highlight{margin:1.6em 0}h1,h2,h3,h4{margin:0;padding:0;font-size:100%;font-weight:bold;text-rendering:optimizeLegibility;font-family:sans-serif}ul{list-style:none}html{box-sizing:border-box;font-size:62.5%}*{box-sizing:inherit}*:before,*:after{box-sizing:inherit}img{height:auto;max-width:100%}pre,code{font-family:monospace;margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:1rem 0;padding:0}blockquote{font-style:italic;margin:1.6em 0 1.6em -2.2em;padding:0 0 0 1.6em;border-left:#4a4a4a 0.4em solid}html{font-size:16px}@media screen and (min-width: 900px){html{font-size:18px}}@media screen and (min-width: 1200px){html{font-size:20px}}body{font-family:serif;color:#3A4145}h1{font-size:2rem;margin:10px 0 10px 0;letter-spacing:-1px}h2{font-size:1.4rem;letter-spacing:-1px}h3{font-size:1.2rem}h4{font-size:1.1rem}a:link,a:visited{color:inherit;text-decoration:none}a:hover{color:#57A3E8;transition:color ease 0.3s}p a:link,p a:visited{text-decoration:underline}pre{border:1px solid #E3EDF3;padding:10px;font-size:0.85em;border-radius:3px}code{padding:1px 3px;font-size:0.85em;white-space:pre;border:1px solid #E3EDF3;background:#F7FAFB;border-radius:2px}pre code{background:transparent;padding:0;border:0}.m-h{text-align:center;background-color:#303538;color:#fff;padding:1rem}.m-h h2{font-weight:normal;font-size:1.5rem}article{width:80%;margin:1rem auto;padding-bottom:1rem;border-bottom:#EBF2F6 1px solid;word-break:break-word;position:relative}article::after{display:block;content:"";width:7px;height:7px;border:#E7EEF2 1px solid;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;box-shadow:#fff 0 0 0 5px}.a-m{color:#9EABB3;font-size:0.8rem}.a-m a:hover{color:#9EABB3;text-decoration:underline}.a-h{margin-bottom:5px}.r-m{font-size:smaller}nav{position:relative;width:75%;margin:1rem auto;font-size:0.8rem;color:#9EABB3;text-align:center}.m-f{position:relative;margin:2rem 0 0 0;padding:1rem 1rem 2rem 1rem;border-top:#EBF2F6 1px solid;font-size:0.8rem;line-height:1.7em;color:#BBC7CC;text-align:center;background:#F7FAFB}.o-p,.n-p{position:absolute;display:inline-block;padding:0 0.5rem;border:#EBF2F6 2px solid;text-decoration:none;border-radius:30px;transition:border ease 0.3s}.o-p{right:0}.n-p{left:0}.t-h{width:80%;margin:0 auto}.highlight pre{background-color:#49483e;color:white;overflow:scroll}.ge{font-style:italic}.gs{font-weight:bold}.c,.cm,.cp,.c1,.gu,.cs{color:#75715e}.k,.kc,.kd,.kp,.kr,.no,.kt{color:#66d9ef}.l,.mf,.mh,.mi,.mo,.se,.il,.m{color:#ae81ff}.n,.nb,.ni,.nl,.nn,.py,.nv,.w,.bp,.vc,.vg,.vi,.p{color:#f8f8f2}.o,.nt,.ow,.gd,.kn{color:#f92672}.ld,.sb,.sc,.sd,.s2,.sh,.si,.sx,.sr,.s1,.ss,.s{color:#e6db74}.na,.nc,.nd,.ne,.nf,.nx,.gi{color:#a6e22e}

    </style>

    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Extension Methods - Chris Sainty</title>
<meta property="og:title" content="Extension Methods" />
<meta name="description" content="In this article I am going to look at Extension Methods. Although this is not a specific to LINQ post, Extension Methods are the compiler concept that LINQ was built on.  The basic premise is to allow the developer to add functionality to any class they like without the need to subclass it or wrap it in a wrapper class. This is a great new technique because it allows you to continue using a class like String or DateTime and not need to remember to use MyString and MyDateTime or fall back on static helper classes.  " />
<meta property="og:description" content="In this article I am going to look at Extension Methods. Although this is not a specific to LINQ post, Extension Methods are the compiler concept that LINQ was built on.  The basic premise is to allow the developer to add functionality to any class they like without the need to subclass it or wrap it in a wrapper class. This is a great new technique because it allows you to continue using a class like String or DateTime and not need to remember to use MyString and MyDateTime or fall back on static helper classes.  " />
<link rel="canonical" href="https://blog.csainty.com/2008/01/extension-methods.html" />
<meta property="og:url" content="https://blog.csainty.com/2008/01/extension-methods.html" />
<meta property="og:site_name" content="Chris Sainty" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-01-13T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@csainty" />
<meta name="twitter:creator" content="@Chris Sainty" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Extension Methods",
    "datePublished": "2008-01-13T00:00:00+00:00",
    "description": "In this article I am going to look at Extension Methods. Although this is not a specific to LINQ post, Extension Methods are the compiler concept that LINQ was built on.  The basic premise is to allow the developer to add functionality to any class they like without the need to subclass it or wrap it in a wrapper class. This is a great new technique because it allows you to continue using a class like String or DateTime and not need to remember to use MyString and MyDateTime or fall back on static helper classes.  ",
    "url": "https://blog.csainty.com/2008/01/extension-methods.html"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
  <header class="m-h">
    <h1><a href="https://blog.csainty.com">Chris Sainty</a></h1>
    <h2>A technical blog covering full-stack web development.</h2>
    <h2><a href="https://twitter.com/csainty" rel="external">twitter</a> | <a href="https://github.com/csainty" rel="external">github</a> | <a href="https://stackoverflow.com/users/625695/chris-sainty" rel="external">stackoverflow</a></h2>
  </header>

  <article>
    <span><time datetime="13 Jan 2008">13 Jan 2008</time>  </span>
    <h1>Extension Methods</h1>
    <section>
        <p>In this article I am going to look at Extension Methods. Although this is not a specific to LINQ post, Extension Methods are the compiler concept that LINQ was built on.  </p>

<p>The basic premise is to allow the developer to add functionality to any class they like without the need to subclass it or wrap it in a wrapper class. This is a great new technique because it allows you to continue using a class like String or DateTime and not need to remember to use MyString and MyDateTime or fall back on static helper classes.  </p>

<!-- more -->

<p>So how do we go about doing this?    I have recently been working on a tool that constantly needs to convert DateTime values from my local time zone here in Australia (GMT +10) to Central US time (GMT -6). Traditionally you would probably create a static helper class with a method that takes the time in one form and passes it back in the other, just to save you writing the conversion code in every place that uses it. Ignore the simplicity of the time conversion here, this is simply to keep the code short.  </p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Test_Application</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">class</span> <span class="nc">ExtensionMethods</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">DateTime</span> <span class="nf">LocalTimeToCentral</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">dt</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">dt</span><span class="p">.</span><span class="nf">ToUniversalTime</span><span class="p">().</span><span class="nf">AddHours</span><span class="p">(-</span><span class="m">6</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>To call this in our code would look like this  </p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">DateTime</span> <span class="n">dt</span> <span class="p">=</span> <span class="n">ExtensionMethods</span><span class="p">.</span><span class="nf">LocalTimeToCentral</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">);</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Central - "</span> <span class="p">+</span> <span class="n">dt</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
</code></pre></div>
<p>It works, but it could be nicer. With a very simple tweak we can now attach this method to the DateTime class itself. Check this out.  </p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Test_Application</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">class</span> <span class="nc">ExtensionMethods</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">DateTime</span> <span class="nf">ToCentral</span><span class="p">(</span><span class="k">this</span> <span class="n">DateTime</span> <span class="n">dt</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">dt</span><span class="p">.</span><span class="nf">ToUniversalTime</span><span class="p">().</span><span class="nf">AddHours</span><span class="p">(-</span><span class="m">6</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>By simply adding a new keyword &quot;this&quot; in front of the first parameter (I renamed the method simply to have a name consistent with it&#39;s new usage) we have created an Extension method. Now any DateTime class used where the Test_Application namespace is in use will have a ToCentral() method.</p>

<p>Note that the parameter with &quot;this&quot; does not convert into a parameter on the new method, it maps to the instance you are working on. Subsequent parameters will flow onto the method though. You will see this later.  </p>

<p>We can now use this method like this  </p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">DateTime</span> <span class="n">dt</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">ToCentral</span><span class="p">();</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Central - "</span> <span class="p">+</span> <span class="n">dt</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
</code></pre></div>
<p>Of course this comes with full intellisense and compile time type checking.</p>

<p>Extension Methods add a whole new level to what component developers can offer us, but you should not pass up opportunities to use them in your day to day coding.  </p>

<p>For one last code sample I am going to implement a very basic subset of the functionality of the Visual FoxPro StrExtract() method. I have talked about it before and how much I like it for basic string parsing. Without much work you could use Extension Methods to add an Extract() method to the string class in the .NET. Here is a start.  </p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Test_Application</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">class</span> <span class="nc">ExtensionMethods</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Extract</span><span class="p">(</span><span class="k">this</span> <span class="kt">string</span> <span class="n">s</span><span class="p">,</span> <span class="kt">string</span> <span class="n">start</span><span class="p">,</span> <span class="kt">string</span> <span class="n">end</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">ret</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">startPos</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="p">+</span> <span class="n">start</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">endPos</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">IndexOf</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">startPos</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">startPos</span> <span class="p">&gt;=</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">endPos</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">ret</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">endPos</span> <span class="p">-</span> <span class="n">startPos</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>And to call it.  </p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">string</span> <span class="n">s</span> <span class="p">=</span> <span class="s">"&lt;text&gt;&lt;first&gt;First Test&lt;/first&gt;&lt;second&gt;Second Test&lt;/second&gt;&lt;/text&gt;"</span><span class="p">;</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="nf">Extract</span><span class="p">(</span><span class="s">"&lt;first&gt;"</span><span class="p">,</span> <span class="s">"&lt;/first&gt;"</span><span class="p">));</span> <span class="c1">// First Test
</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="nf">Extract</span><span class="p">(</span><span class="s">"&lt;second&gt;"</span><span class="p">,</span> <span class="s">"&lt;/second&gt;"</span><span class="p">));</span> <span class="c1">// Second Test
</span></code></pre></div>
<p>Fantastic!  </p>

    </section>
</article>


  <footer class="m-f">
      <section class="copyright">All content copyright <a href="/">Chris Sainty</a> &copy; 2006-2017 &bull; All rights reserved.</section>
  </footer>
</body>
</html>

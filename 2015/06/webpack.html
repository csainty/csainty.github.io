<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="/images/favicon.png" />
    <style>
    html,body,li,p{margin:0;padding:0}p,ul,ol,.highlight{margin:1.6em 0}h1,h2,h3,h4{margin:0;padding:0;font-size:100%;font-weight:bold;text-rendering:optimizeLegibility;font-family:sans-serif}ul{list-style:none}html{box-sizing:border-box;font-size:62.5%}*{box-sizing:inherit}*:before,*:after{box-sizing:inherit}img{height:auto;max-width:100%}pre,code{font-family:monospace;margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:1rem 0;padding:0}blockquote{font-style:italic;margin:1.6em 0 1.6em -2.2em;padding:0 0 0 1.6em;border-left:#4a4a4a 0.4em solid}html{font-size:16px}@media screen and (min-width: 900px){html{font-size:18px}}@media screen and (min-width: 1200px){html{font-size:20px}}body{font-family:serif;color:#3A4145}h1{font-size:2rem;margin:10px 0 10px 0;letter-spacing:-1px}h2{font-size:1.4rem;letter-spacing:-1px}h3{font-size:1.2rem}h4{font-size:1.1rem}a:link,a:visited{color:inherit;text-decoration:none}a:hover{color:#57A3E8;transition:color ease 0.3s}p a:link,p a:visited{text-decoration:underline}pre{border:1px solid #E3EDF3;padding:10px;font-size:0.85em;border-radius:3px}code{padding:1px 3px;font-size:0.85em;white-space:pre;border:1px solid #E3EDF3;background:#F7FAFB;border-radius:2px}pre code{background:transparent;padding:0;border:0}.m-h{text-align:center;background-color:#303538;color:#fff;padding:1rem}.m-h h2{font-weight:normal;font-size:1.5rem}article{width:80%;margin:1rem auto;padding-bottom:1rem;border-bottom:#EBF2F6 1px solid;word-break:break-word;position:relative}article::after{display:block;content:"";width:7px;height:7px;border:#E7EEF2 1px solid;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;box-shadow:#fff 0 0 0 5px}.a-m{color:#9EABB3;font-size:0.8rem}.a-m a:hover{color:#9EABB3;text-decoration:underline}.a-h{margin-bottom:5px}.r-m{font-size:smaller}nav{position:relative;width:75%;margin:1rem auto;font-size:0.8rem;color:#9EABB3;text-align:center}.m-f{position:relative;margin:2rem 0 0 0;padding:1rem 1rem 2rem 1rem;border-top:#EBF2F6 1px solid;font-size:0.8rem;line-height:1.7em;color:#BBC7CC;text-align:center;background:#F7FAFB}.o-p,.n-p{position:absolute;display:inline-block;padding:0 0.5rem;border:#EBF2F6 2px solid;text-decoration:none;border-radius:30px;transition:border ease 0.3s}.o-p{right:0}.n-p{left:0}.t-h{width:80%;margin:0 auto}.highlight pre{background-color:#49483e;color:white;overflow:scroll}.ge{font-style:italic}.gs{font-weight:bold}.c,.cm,.cp,.c1,.gu,.cs{color:#75715e}.k,.kc,.kd,.kp,.kr,.no,.kt{color:#66d9ef}.l,.mf,.mh,.mi,.mo,.se,.il,.m{color:#ae81ff}.n,.nb,.ni,.nl,.nn,.py,.nv,.w,.bp,.vc,.vg,.vi,.p{color:#f8f8f2}.o,.nt,.ow,.gd,.kn{color:#f92672}.ld,.sb,.sc,.sd,.s2,.sh,.si,.sx,.sr,.s1,.ss,.s{color:#e6db74}.na,.nc,.nd,.ne,.nf,.nx,.gi{color:#a6e22e}

    </style>

    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Webpack - Chris Sainty</title>
<meta property="og:title" content="Webpack" />
<meta name="description" content="Webpack has become my standard tooling for front-end assets in recent times. Though for all the in-depth documentation I found the learning curve steep and the number of options confusing. So I&#39;d like to share some of what I learnt." />
<meta property="og:description" content="Webpack has become my standard tooling for front-end assets in recent times. Though for all the in-depth documentation I found the learning curve steep and the number of options confusing. So I&#39;d like to share some of what I learnt." />
<link rel="canonical" href="https://blog.csainty.com/2015/06/webpack.html" />
<meta property="og:url" content="https://blog.csainty.com/2015/06/webpack.html" />
<meta property="og:site_name" content="Chris Sainty" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-06-26T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@csainty" />
<meta name="twitter:creator" content="@Chris Sainty" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Webpack",
    "datePublished": "2015-06-26T00:00:00+00:00",
    "description": "Webpack has become my standard tooling for front-end assets in recent times. Though for all the in-depth documentation I found the learning curve steep and the number of options confusing. So I&#39;d like to share some of what I learnt.",
    "url": "https://blog.csainty.com/2015/06/webpack.html"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
  <header class="m-h">
    <h1><a href="https://blog.csainty.com">Chris Sainty</a></h1>
    <h2>A technical blog covering full-stack web development.</h2>
    <h2><a href="https://twitter.com/csainty" rel="external">twitter</a> | <a href="https://github.com/csainty" rel="external">github</a> | <a href="https://stackoverflow.com/users/625695/chris-sainty" rel="external">stackoverflow</a></h2>
  </header>

  <article>
    <span><time datetime="26 Jun 2015">26 Jun 2015</time>  </span>
    <h1>Webpack</h1>
    <section>
        <p><a href="http://webpack.github.io/">Webpack</a> has become my standard tooling for front-end assets in recent times. Though for all the in-depth documentation I found the learning curve steep and the number of options confusing. So I&#39;d like to share some of what I learnt.</p>

<!-- more -->

<h3>Getting started</h3>

<p>Webpack is an <a href="http://npmjs.org">npm</a> module. You can install it globally <code>npm install webpack -g</code> or bring it in to your existing tooling - <a href="http://webpack.github.io/docs/usage-with-grunt.html">grunt</a> or <a href="http://webpack.github.io/docs/usage-with-gulp.html">gulp</a>.<br>
For the purposes of this blog I will use a globally installed copy from the command line. In this scenario you need to create a <code>webpack.config.js</code> file to store you setup.</p>

<h3>Javascript modules and concatenation</h3>

<p>Webpack can do a lot, but let&#39;s focus on the first thing you are likely to use it for first, handling javascript modules and building concatenated production assets.</p>

<p>Consider the following two <code>.js</code> files, first the main file we want to run on our page, second a service providing some functionality.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// index.js</span>
<span class="kd">var</span> <span class="nx">greeter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./greeter'</span><span class="p">);</span>
<span class="nx">greeter</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="s1">'world'</span><span class="p">);</span>

<span class="c1">// greeter.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">greet</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Hello '</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p>Getting webpack to handle the process of resolving this dependency is actually really easy. You simply provide the entry point, the file that runs first, and the output location.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// webpack.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="s1">'./index.js'</span><span class="p">,</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">filename</span><span class="p">:</span> <span class="s1">'bundle.js'</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p>Webpack will resolve the <code>require()</code> statement at the top of <code>index.js</code> and include it in the output for us.</p>

<h3>Multi-page websites</h3>

<p>The truth is not many of us build single page apps like that example above tends towards. So let&#39;s define multiple entry points, one for each page that requires javascript.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// home.js</span>
<span class="kd">var</span> <span class="nx">greeter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./greeter'</span><span class="p">);</span>
<span class="nx">greeter</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="s1">'home world'</span><span class="p">);</span>

<span class="c1">// about.js</span>
<span class="kd">var</span> <span class="nx">greeter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./greeter'</span><span class="p">);</span>
<span class="nx">greeter</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="s1">'about world'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// webpack.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">home</span><span class="p">:</span> <span class="s1">'./home.js'</span><span class="p">,</span>
        <span class="na">about</span><span class="p">:</span> <span class="s1">'./about.js'</span>
    <span class="p">},</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="s1">'./dist'</span><span class="p">,</span>
        <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js'</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p>With this set up, webpack will process each entry point, resolve its dependencies and create multiple output files. We use <code>[name]</code> in the output file name to give the bundles different names. In this case <code>home</code> and <code>about</code>.</p>

<h3>Shared modules</h3>

<p>But now we have <code>greeter.js</code> being duplicated in to both the <code>home</code> and <code>about</code> bundles. What we want is to extract <code>greeter.js</code> and other shared modules out in to their own file which we can include on every page. Of course webpack makes this simple with some additional config.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// webpack.config.js</span>
<span class="kd">var</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'webpack'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">home</span><span class="p">:</span> <span class="s1">'./home.js'</span><span class="p">,</span>
        <span class="na">about</span><span class="p">:</span> <span class="s1">'./about.js'</span>
    <span class="p">},</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="s1">'./dist'</span><span class="p">,</span>
        <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js'</span>
    <span class="p">},</span>
    <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
            <span class="na">name</span><span class="p">:</span> <span class="s1">'common'</span><span class="p">,</span>
            <span class="na">minChunks</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">})</span>
    <span class="p">]</span>
<span class="p">};</span>
</code></pre></div>
<p>The <code>CommonsChunkPlugin</code> will automatically find common modules and extract them in to a shared file for you. Then you simple have two script references in your page.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"common.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"home.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>
<h3>Minification</h3>

<p>By default webpack emits unminified source. The pieces it adds for module resolution are also quite verbose with comments and whitespace. For production we need to add minification and scriptmaps. Let&#39;s add that config now.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// webpack.config.js</span>
<span class="kd">var</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'webpack'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">home</span><span class="p">:</span> <span class="s1">'./home.js'</span><span class="p">,</span>
        <span class="na">about</span><span class="p">:</span> <span class="s1">'./about.js'</span>
    <span class="p">},</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="s1">'./dist'</span><span class="p">,</span>
        <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js'</span>
    <span class="p">},</span>
    <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
            <span class="na">name</span><span class="p">:</span> <span class="s1">'common'</span><span class="p">,</span>
            <span class="na">minChunks</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}),</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">UglifyJsPlugin</span><span class="p">(),</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">SourceMapDevToolPlugin</span><span class="p">({</span>
            <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js.map'</span>
        <span class="p">})</span>
    <span class="p">]</span>
<span class="p">};</span>
</code></pre></div>
<h3>ES6</h3>

<p>Finally let&#39;s introduce ES6, we want all that goodness now. To add ES6 support via <a href="https://babeljs.io/">babel</a> we need to use a webpack loader. Loaders act as pre-processors over input files. A lot of webpack&#39;s power is added with various loaders.<br>
So let&#39;s <code>npm install --save babel-loader</code> and update our <code>webpack.config.js</code>.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// webpack.config.js</span>
<span class="kd">var</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'webpack'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">home</span><span class="p">:</span> <span class="s1">'./home.js'</span><span class="p">,</span>
        <span class="na">about</span><span class="p">:</span> <span class="s1">'./about.js'</span>
    <span class="p">},</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="s1">'./dist'</span><span class="p">,</span>
        <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js'</span>
    <span class="p">},</span>
    <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
            <span class="na">name</span><span class="p">:</span> <span class="s1">'common'</span><span class="p">,</span>
            <span class="na">minChunks</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}),</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">UglifyJsPlugin</span><span class="p">(),</span>
        <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">SourceMapDevToolPlugin</span><span class="p">({</span>
            <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js.map'</span>
        <span class="p">})</span>
    <span class="p">],</span>
    <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">loaders</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">js$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'babel'</span> <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p>Now all <code>.js</code> files will be run through babel. So we can update our two pages and our shared module.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// home.js</span>
<span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">greeter</span> <span class="nx">from</span> <span class="s1">'./greeter'</span><span class="p">;</span>
<span class="nx">greeter</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="s1">'home world'</span><span class="p">);</span>

<span class="c1">// about.js</span>
<span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">greeter</span> <span class="nx">from</span> <span class="s1">'./greeter'</span><span class="p">;</span>
<span class="nx">greeter</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="s1">'about world'</span><span class="p">);</span>

<span class="c1">// greeter.js</span>
<span class="kr">export</span> <span class="kd">function</span> <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">`</span><span class="nx">Hello</span> <span class="nx">$</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="err">`</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3>Summary</h3>

<p>Wrapping it up, we have quickly created a pipeline for our javascript that allows us to structure our code around modules, write them in ES6, and deliver them minified and concatenated to the client.<br>
We have only scratched the surface of webpack (just check this list of <a href="http://webpack.github.io/docs/list-of-loaders.html">loaders</a>!) but I hope this article helps introduce you to some of the core uses.</p>

    </section>
</article>


  <footer class="m-f">
      <section class="copyright">All content copyright <a href="/">Chris Sainty</a> &copy; 2006-2017 &bull; All rights reserved.</section>
  </footer>
</body>
</html>
